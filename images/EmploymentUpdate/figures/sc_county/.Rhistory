#dev.copy2pdf(file=paste(outloc_temp,"sc_lf.pdf",sep="/"),pointsize=12,width=8,height=6)
#dev.print(png,file=paste(outloc_temp,"sc_lf.png",sep="/"),pointsize=12,width=8,height=6,bg="white",res=400,units="in")
outloc_temp <- NULL
#dev.off()
# }}}
# Industries {{{
industrylist_all       <- unique(sort(data_scindustries$Industry))
industrylist_short     <- c('Educational and Health Services','Financial Activities','Goods Producing',
'Government','Information','Leisure and Hospitality','Other Services',
'Professional and Business Services','Retail Trade','Total Farm',
'Transportation, Warehousing and Utilitie','Wholesale Trade')
industrylist_names     <- c('Educ. & Health Services','Financial Activities','Goods Producing','Government',
'Information','Leisure & Hospitality','Other Services','Prof. & Bus. Services',
'Retail Trade','Total Farm','Trans., Ware. & Util.','Wholesale Trade')
industrylist_savenames <- c('eh','fin','goods','govt','info','lh','otherservices','pbs','retail','farm',
'twu','wholesale')
employment_industry_all <- NULL
ind_comp_fig_MoM        <- NULL
ind_comp_fig_YoY        <- NULL
for (i in 1:length(industrylist_short)) {
employment_industry          <- ts(data_scindustries[which(data_scindustries$Area ==
'San Jose-Sunnyvale-Santa Clara MSA' & data_scindustries$Industry ==
industrylist_short[i] & data_scindustries$Period != 'Annual'),8],
c(1990,01),deltat=1/12)
employment_industry_adj      <- x12(employment_industry)
employment_industry_MoM      <- Delt(employment_industry_adj@d11)[length(employment_industry)]
employment_industry_YoY      <- Delt(employment_industry_adj@d11,k=12)[length(employment_industry)]
employment_industry_current  <- employment_industry_adj@d11[length(employment_industry)]
employment_industry_all[[i]] <- data.frame(industrylist_short[i],employment_industry_current,
employment_industry_MoM,employment_industry_YoY)
ind_comp_fig_MoM[[i]]        <- data.frame(industrylist_names[i],employment_industry_MoM,1,0)
ind_comp_fig_YoY[[i]]        <- data.frame(industrylist_names[i],employment_industry_YoY,1,0)
# Plots {{{
employment_industry_MoM_round <- round((employment_industry_adj@d11[length(employment_industry_adj@d11)]
-employment_industry_adj@d11[length(employment_industry_adj@d11)-1])
/employment_industry_adj@d11[length(employment_industry_adj@d11)-1]*100,
digits=2)
employment_industry_YoY_round <- round((employment_industry_adj@d11[length(employment_industry_adj@d11)]
-employment_industry_adj@d11[length(employment_industry_adj@d11)-12])
/employment_industry_adj@d11[length(employment_industry_adj@d11)-12]*100,
digits=2)
emples <- merge(as.xts(employment_industry_adj@a1/1000),as.xts(employment_industry_adj@d11/1000))
names(emples) <- c("Original","Seasonally Adjusted")
outloc_temp <- paste(paste(paste(outloc_figs,fig_folder,sep="/"),"sc_county",sep="/"),"industries",sep="/")
par(family='serif')
png(file=paste(outloc_temp,paste("sc_empl_",paste(industrylist_savenames[i],'.png',sep=""),sep=""),sep="/"),
pointsize=12,width=10,height=8,bg="white",res=400,units="in")
plot.new()
chart.TimeSeries(emples["1999-12-30/"],
lwd=3,
las=1,
cex.main=1.2,
cex.axis=1.2,
colorset=EFPcolors,
main="",
ylab="",
xlab="",
type="l",
bty="l",
period.areas=cycles.dates,
period.color="lightsteelblue1",
grid.color = "grey70",
grid.lty = "dotted",
minor.ticks=FALSE,
date.format="%Y",
major.ticks="years",#major.ticks="annual",
legend.loc="topleft",
pch=NULL)
box(col="white",lwd=3)
mtext(paste(industrylist_names[i], ", Santa Clara County",sep=""),
adj=0,
line=2,
cex=1.7,
font=2)
mtext("Number Employed (Thousands)",
side=3,
line=.5,
adj=0,
cex=1.4)
mtext(paste("Most Recent (Unadjusted) =",format(round(employment_industry_adj@a1[length(employment_industry_adj@a1)]),big.mark=",",scientific=F)),
side = 1,
line= 2.2,
cex = .8,
adj = 0)
mtext(paste("Most Recent (Adjusted) =",format(round(employment_industry_adj@d11[length(employment_industry_adj@d11)]),big.mark=",",scientific=F)),
side = 1,
line= 2.9,
cex = .8,
adj = 0)
mtext(paste("Percent Change (Month) =",employment_industry_MoM_round,"%  and  Percent Change (Year) =",employment_industry_YoY_round,"%"),
side = 1,
line= 3.5,
cex = .8,
adj = 0)
dev.off()
#dev.copy2pdf(file=paste(outloc_temp,paste("sc_empl_",paste(industrylist_savenames[i],'.pdf',sep=""),sep=""),sep="/"),
#             pointsize=12,width=8,height=6)
#dev.print(png,file=paste(outloc_temp,paste("sc_empl_",paste(industrylist_savenames[i],'.png',sep=""),sep=""),sep="/"),
#          pointsize=12,width=10,height=8,bg="white",res=400,units="in")
outloc_temp <- NULL
#dev.off()
# }}}
}
# Now do stuff to make a table
employment_industry_combined                   <- do.call("rbind",employment_industry_all)
employment_total                               <- sum(employment_industry_combined$employment_industry_current)
employment_industry_combined$employment_pcttot <- employment_industry_combined$employment_industry_current/employment_total
employment_industry_combined_reorder           <- employment_industry_combined
# add in total and nonfarm:
employment_industry_combined_reorder[3:(dim(employment_industry_combined_reorder)[1]+2),] <- employment_industry_combined_reorder[1:dim(employment_industry_combined_reorder)[1],]
employment_industry_combined_reorder$industrylist_short.i. <- as.character(employment_industry_combined_reorder$industrylist_short.i.)
# tot
employment_industry_combined_reorder[1,1] <- "Total, All Industries"
employment_industry_combined_reorder[1,2] <- santaclara_total_adj@d11[length(santaclara_total)]
employment_industry_combined_reorder[1,3] <- Delt(santaclara_total_adj@d11)[length(santaclara_total)]
employment_industry_combined_reorder[1,4] <- Delt(santaclara_total_adj@d11,k=12)[length(santaclara_total)]
employment_industry_combined_reorder[1,5] <- ""
# nonfarm:
employment_industry_combined_reorder[2,1] <- "Total Nonfarm"
employment_industry_combined_reorder[2,2] <- santaclara_nonfarm_adj@d11[length(santaclara_nonfarm)]
employment_industry_combined_reorder[2,3] <- Delt(santaclara_nonfarm_adj@d11)[length(santaclara_nonfarm)]
employment_industry_combined_reorder[2,4] <- Delt(santaclara_nonfarm_adj@d11,k=12)[length(santaclara_nonfarm)]
employment_industry_combined_reorder[2,5] <- ""
write.csv(employment_industry_combined_reorder,file=paste(outloc_tables,table_folder,"sc_industry_table.csv",sep="/"))
# }}}
# Industry Composition {{{
# Year over Year (YoY)
ind_comp_fig_YoY_combined$up      <- c(1,1,1,1,1,1,-1,1,-1,1,-1,1)
ind_comp_fig_YoY_combined$textadj <- c(0,0,0,0,0,0,0,-0.5,-0.4,0,0,-0.3)
ind_comp_fig_YoY_combined$numadj  <- c(0,0,0,0,0,0,0,0,0,0,0,0)
data <- ind_comp_fig_YoY_combined
df   <- data.frame(x=data$TITLE,width=data$weight*100, height=data$growth.rate*100,up=data$up,
textadj=data$textadj,numadj=data$numadj)
df$w           <- cumsum(df$width)
df$wm          <- (df$w - df$width)
df$wt          <- (with(df,  wm+(w-wm)/2))
df$width_round <- round(df$width,digits = 1)
p  <- ggplot(df, aes(ymin=0),height=4,width=8)
pl <- p + geom_rect(aes(xmin=wm, xmax=w, ymax=height, fill=x))
p2 <- pl + geom_text(aes(x=wt-(wt>98)*5, y=height+sign(height)*0.25+textadj, label=x),
family="Times", size=3) + geom_text(aes(x=wt, y=0.3*(up)+numadj, label=width_round), ,family="Times", size=4)
p3 <- p2 + theme_classic(base_size=12, base_family="Times")
p4 <- p3 + labs(x="Percent of Total Employment", y=paste(format(enddate-365,"%b %Y")," - ",
format(enddate,"%b %Y")," Growth Rate (%)",sep=""), title=paste(format(enddate,"%B %Y"),
" Employment by Industry \n Santa Clara County",sep="")) + geom_hline(aes(yintercept=0),linetype=1)
p5 <- p4 + theme(axis.title=element_text(size=10),legend.position = "none",plot.title = element_text(size = 14,
face = "bold", colour = "black", vjust = -1)) + scale_y_continuous() + scale_x_continuous(expand = c(0, 0),
limits=c(0,102))
par(fin=c(6.5,4),pin=c(6,3), family="Times",mai=c(1,.2,.6,.2))
outloc_temp <- paste(paste(paste(outloc_figs,fig_folder,sep="/"),"sc_county",sep="/"),"industries/",sep="/")
png(file=paste(outloc_temp,"sc_indcomp_YoY",".png",sep=""),pointsize=12,width=8,height=4,bg="white",res=400,units="in")
plot(p5)
dev.off()
#dev.copy2pdf(file=paste(outloc_temp,"sc_indcomp_YoY.pdf",sep=""),pointsize=12,width=8,height=4)
#dev.print(png,file=paste(outloc_temp,"sc_indcomp_YoY",".png",sep=""),pointsize=12,width=8,height=4,bg="white",res=400,units="in")
outloc_temp <- NULL
#dev.off()
# Month over Month (MoM)
ind_comp_fig_MoM_combined$up      <- c(1,1,1,1,1,1,1,1,1,-1,1,-1)
ind_comp_fig_MoM_combined$textadj <- c(0,0,0,0,-.035,0,0,0,0,0,0,0)
ind_comp_fig_MoM_combined$numadj  <- c(0,0,0,0,0,0,0,0,0,0,0,0)
data <- ind_comp_fig_MoM_combined
df   <- data.frame(x=data$TITLE,width=data$weight*100, height=data$growth.rate*100,up=data$up,
textadj=data$textadj,numadj=data$numadj)
df$w           <- cumsum(df$width)
df$wm          <- (df$w - df$width)
df$wt          <- (with(df,  wm+(w-wm)/2))
df$width_round <- round(df$width,digits = 1)
p  <- ggplot(df, aes(ymin=0),height=4,width=8)
pl <- p + geom_rect(aes(xmin=wm, xmax=w, ymax=height, fill=x))
p2 <- pl + geom_text(aes(x=wt-(wt>98)*5, y=height+sign(height)*0.03+textadj, label=x),
family="Times", size=3) + geom_text(aes(x=wt, y=.035*(up)+numadj, label=width_round), ,family="Times", size=4)
p3 <- p2 + theme_classic(base_size=12, base_family="Times")
p4 <- p3 + labs(x="Percent of Total Employment", y=paste(format(enddate-1,"%b")," - ",format(enddate,"%b %Y"),
" Growth Rate (%)",sep=""), title=paste(format(enddate,"%B %Y")," Employment by Industry \n Santa Clara County",
sep="")) + geom_hline(aes(yintercept=0),linetype=1)
p5 <- p4 + theme(axis.title=element_text(size=10),legend.position = "none",plot.title = element_text(size = 14,
face = "bold", colour = "black", vjust = -1)) + scale_y_continuous() + scale_x_continuous(expand = c(0, 0),
limits=c(0,102))
par(fin=c(6.5,4),pin=c(6,3), family="Times",mai=c(1,.2,.6,.2))
outloc_temp <- paste(paste(paste(outloc_figs,fig_folder,sep="/"),"sc_county",sep="/"),"industries/",sep="/")
png(file=paste(outloc_temp,"sc_indcomp_MoM",".png",sep=""),pointsize=12,width=8,height=4,bg="white",res=400,units="in")
plot(p5)
dev.off()
#dev.copy2pdf(file=paste(outloc_temp,"sc_indcomp_MoM.pdf",sep=""),pointsize=12,width=8,height=4)
#dev.print(png,file=paste(outloc_temp,"sc_indcomp_MoM",".png",sep=""),pointsize=12,width=8,height=4,bg="white",res=400,units="in")
outloc_temp <- NULL
#dev.off()
# }}}
# }}}
# }}}
# -------------------------------------- #
#                                        #
#       Stuff Below Here is a Mess       #
#                                        #
# -------------------------------------- #
## {{{
#
## -------------------------- #
## ----- Revision Check ----- #
## -------------------------- #
#
#sbc_uerate_pre <- ts(data_sbcemployment_pre[which(data_sbcemployment_pre$Area == 'Santa Maria-Santa Barbara MSA' & data_sbcemployment_pre$Period != 'Annual'),9],c(1990,01),deltat=1/12)
#sbc_empl_pre   <- ts(data_sbcemployment_pre[which(data_sbcemployment_pre$Area == 'Santa Maria-Santa Barbara MSA' & data_sbcemployment_pre$Period != 'Annual'),7],c(1990,01),deltat=1/12)
#sbc_lf_pre     <- ts(data_sbcemployment_pre[which(data_sbcemployment_pre$Area == 'Santa Maria-Santa Barbara MSA' & data_sbcemployment_pre$Period != 'Annual'),6],c(1990,01),deltat=1/12)
#sbc_unemp_pre  <- ts(data_sbcemployment_pre[which(data_sbcemployment_pre$Area == 'Santa Maria-Santa Barbara MSA' & data_sbcemployment_pre$Period != 'Annual'),8],c(1990,01),deltat=1/12)
#
#revisions      <- NULL
#revisions[[1]] <- sbc_uerate - sbc_uerate_pre
#revisions[[2]] <- sbc_empl - sbc_empl_pre
#revisions[[3]] <- sbc_lf - sbc_lf_pre
#revisions[[4]] <- sbc_unemp - sbc_unemp_pre
#
#var_names  <- c("Unemployment Rate", "Employment", "Labor Force", "Unemployment")
#var_names2 <- c("UnemploymentRate", "Employment", "LaborForce", "Unemployment")
#
#for (i in 1:length(var_names)){
#    emples<-merge(as.xts(revisions[[i]]))
#    names(emples)<- c("(Current)-(Previous)")
#    par(family='serif')
#    chart.TimeSeries(emples["2008-12-30/"],
#        lwd=3,
#        las=1,
#        cex.main=1.2,
#        cex.axis=1.2,
#        col=EFPcolors,
#        main="",
#        ylab="",
#        xlab="",
#        type="l",
#        bty="l",
#        period.areas=cycles.dates,
#        period.color="lightsteelblue1",
#        grid.color = "grey70",
#        grid.lty = "dotted",
#        minor.ticks=FALSE,
#        date.format="%Y",
#        major.ticks="annual",
#        legend.loc="topleft",
#        pch=NULL)
#    box(col="white",lwd=3)
#    mtext("www.efp.ucsb.edu",
#        side = 1,
#        line = 4,
#        cex = .8,
#        adj = 0)
#    mtext(paste(var_names[i]," Revisions, Santa Barbara County",sep=""),
#        adj=0,
#        line=2,
#        cex=1.7,
#        font=2)
#    mtext(paste("Latest Revision =",revisions[[i]][length(revisions[[i]])]),
#        side = 1,
#        line= 3,
#        cex = .8,
#        adj = 0)
#    mtext("Source: California Employment Development Department (EDD)",
#        side = 1,
#        line= 3.2,
#        cex = .8,
#        adj = 1)
#    dev.copy2pdf(file=paste(outloc_figs,"revisions/sbc_revision_",var_names2[i],".pdf",sep=""), pointsize=12, width=8, height=6)
#    #dev.print(png, file=paste(pngoutloc,"revisions/sbc_revision_",var_names2[i],".png", sep=""), pointsize = 12, width = 8, height = 6, bg = "white", res=400, units="in")
#}
#
#
## Loop for Industries
#
## add in total and nonfarm
#industrylist_short          <- c('Total Wage and Salary','Total Nonfarm','Educational and Health Services','Financial Activities','Goods Producing','Government','Information','Leisure and Hospitality','Other Services','Professional and Business Services','Retail Trade','Total Farm','Transportation, Warehousing and Utilitie','Wholesale Trade')
#industrylist_savenames <- c('Total','nonfarm','eh','fin','goods','govt','info','lh','otherservices','pbs','retail','farm','twu','wholesale')
#start                  <- 1
#lastcompletedloop      <- 1
#if (lastcompletedloop < length(industrylist_short)) {
#    print('Not Done')
#    start <- lastcompletedloop
#}
#for (i in start:length(industrylist_short)) {
#    employment_industry         <- ts(data_sbcindustries[which(data_sbcindustries$Area == 'Santa Maria-Santa Barbara MSA' & data_sbcindustries$Industry == industrylist_short[i] & data_sbcindustries$Period != 'Annual'),8],c(1990,01),deltat=1/12)
#    #employment_industry_adj <- x12(employment_industry)
#    employment_industry_pre     <- ts(data_sbcindustries_pre[which(data_sbcindustries_pre$Area == 'Santa Maria-Santa Barbara MSA' & data_sbcindustries_pre$Industry == industrylist_short[i] & data_sbcindustries_pre$Period != 'Annual'),8],c(1990,01),deltat=1/12)
#    #employment_industry_adj_pre <- x12(employment_industry_pre)
#    line        <- as.xts(employment_industry-employment_industry_pre)
#    names(line) <- c("(Current)-(Previous)")
#    par(family='serif')
#    chart.TimeSeries(line,
#        lwd=3,
#        las=1,
#        cex.main=1.2,
#        cex.axis=1.2,
#        col=EFPcolors,
#        main="",
#        ylab="",
#        xlab="",
#        type="l",
#        bty="l",
#        period.areas=cycles.dates,
#        period.color="lightsteelblue1",
#        grid.color = "grey70",
#        grid.lty = "dotted",
#        minor.ticks=FALSE,
#        date.format="%Y",
#        major.ticks="annual",
#        legend.loc="topleft",
#        pch=NULL)
#    box(col="white",lwd=3)
#    mtext("www.efp.ucsb.edu",
#        side = 1,
#        line = 4,
#        cex = .8,
#        adj = 0)
#    mtext(paste(industrylist_short[i], " Employment Revisions, Santa Barbara County",sep=""),
#        adj=0,
#        line=2,
#        cex=1.7,
#        font=2)
#    mtext(paste("Latest Revision =",line[length(line)]),
#        side = 1,
#        line= 3,
#        cex = .8,
#        adj = 0)
#    mtext("Source: California Employment Development Department (EDD)",
#        side = 1,
#        line= 3.2,
#        cex = .8,
#        adj = 1)
#    dev.copy2pdf(file=paste(outloc_figs,"Revisions/sbc_revision_Industry_",industrylist_savenames[i],".pdf",sep=""), pointsize=12, width=8, height=6)
#    print(paste(i,"/",length(industrylist_short)))
#    lastcompletedloop <- i
#}
#
#
## -------------------------- #
## ----- Misc. AMCharts ----- #
## -------------------------- #
#
## Bar Graph with Recent Job Gains
##diff(santabarbara_total_adj@d11)
##diff(santabarbara_nonfarm_adj@d11)
##diff(sbc_empl_x12@d11)
#
## Month Change
#data_nonfarm       <- tail(as.xts(diff(santabarbara_nonfarm_adj@d11)),n=6)
#data_civilian      <- tail(as.xts(diff(sbc_empl_x12@d11)),n=6)
#data               <- merge(data_nonfarm, data_civilian)
#data_temp_1        <- matrix(data,ncol=dim(data)[2])
#data_temp_2        <- data.frame(data_temp_1,as.Date(time(data)))
#names(data_temp_2) <- c("nonfarm_change_sb","civilian_change_sb","date")
#write.csv(data_temp_2,file=paste(outloc_amcharts,"MoM_empl_gains_amchart.csv",sep=""),row.names=FALSE)
## Year Change
#data_nonfarm       <- Delt(santabarbara_nonfarm_adj@d11, k = 12)*100
#data_civilian      <- Delt(sbc_empl_x12@d11, k = 12)*100
## Unadjusted
##data_civilian      <- Delt(sbc_empl_x12@a1,k = 12)*100
##data_nonfarm       <- Delt(santabarbara_nonfarm_adj@a1, k = 12)*100
#annual_loc         <- rep(-1, 5)
#annual_loc[5]      <- length(data_civilian)
#for (i in 1:4) {
#    annual_loc[i] <- length(data_civilian) - 12*(5-i)
#}
#data               <- matrix(0, ncol = 2, nrow = 5)
#data[,1]           <- data_nonfarm[annual_loc]
#data[,2]           <- data_civilian[annual_loc]
##data_nonadj        <- matrix(0, ncol = 2, nrow = 5)
##data_nonadj[,1]    <- data_nonfarm[annual_loc]
##data_nonadj[,2]    <- data_civilian[annual_loc]
#time               <- 2012:2016
#data_temp_1        <- data.frame(data,time)
#names(data_temp_1) <- c("nonfarm_change_sb","civilian_change_sb","date")
#write.csv(data_temp_1,file=paste(outloc_amcharts,"YoY_empl_gains_amchart.csv",sep=""),row.names=FALSE)
#
## Previous Data
#data_pre_1 <- ts(data_sbcindustries_pre[which(data_sbcindustries_pre$Area == 'Santa Maria-Santa Barbara MSA' & data_sbcindustries_pre$Industry == "Total Nonfarm" & data_sbcindustries_pre$Period != 'Annual'),8],c(1990,01),deltat=1/12)
#data_pre_2 <- x12(data_pre_1)
#data_pre   <- tail(as.xts(diff(data_pre_2@d11)),n=5)
#
## Combine New and Old for amcharts
#data_1             <- merge(data,data_pre)
#data_temp_1        <- matrix(data_1,ncol=dim(data_1)[2])
#data_temp_2        <- data.frame(data_temp_1,as.Date(time(data_1)))
#names(data_temp_2) <- c("nonfarm_change_sb_cur","nonfarm_change_sb_cur_pre","date")
#write.csv(data_temp_2,file=paste(outloc_amcharts,"nonfarm_change_revisions_amchart.csv",sep=""),row.names=FALSE)
#
#
## --------------------------------------------- #
## ----- Bar Graphs with Recent Pct Change ----- #
## --------------------------------------------- #
#
## By location (SB, CA, US)
#data_1             <- merge(as.xts(Delt(santabarbara_nonfarm_adj@d11)),as.xts(Delt(cal_nonfarm_x12@d11)),as.xts(Delt(us_nonfarm)))
#data               <- tail(data_1*100,n=6)
#data_temp_1        <- matrix(data,ncol=dim(data)[2])
#data_temp_2        <- data.frame(data_temp_1,as.Date(time(data)))
#names(data_temp_2) <- c("nonfarm_sb","nonfarm_ca","nonfarm_us","date")
#write.csv(data_temp_2,file=paste(outloc_amcharts,"nonfarm_pctchng_amchart.csv",sep=""),row.names=FALSE)
#
## By measure for Santa Barbara (total civ emp, nonfarm emp, total wage and salary)
#data_1             <- merge(as.xts(Delt(santabarbara_nonfarm_adj@d11)),as.xts(Delt(santabarbara_total_adj@d11)),as.xts(Delt(sbc_empl_x12@d11)))
#data               <- tail(data_1*100,n=6)
#data_temp_1        <- matrix(data,ncol=dim(data)[2])
#data_temp_2        <- data.frame(data_temp_1,as.Date(time(data)))
#names(data_temp_2) <- c("nonfarm","totalws","civempl","date")
#write.csv(data_temp_2,file=paste(outloc_amcharts,"varempl_pctchng_sb_amchart.csv",sep=""),row.names=FALSE)
#
#
## ------------------------------------------ #
## ----- Cities Unemployment Rate Chart ----- #
## ------------------------------------------ #
#
#sbcities_edd     <- c("Buellton city", "Carpinteria city", "Goleta City", "Guadalupe city", "Lompoc city", "Santa Barbara city", "Santa Maria city", "Solvang city")
#sbcities_edd_out <- c("Buellton", "Carpinteria", "Goleta", "Guadalupe", "Lompoc", "SantaBarbara", "SantaMaria", "Solvang")
#for (i in 1:length(sbcities_edd)){
#    uerate_city     <- ts(data_city_all$Unemployment.Rate[which(data_city_all$Area == sbcities_edd[i])],start = 2010,deltat = 1/12)
#    uerate_city_x12 <- x12(uerate_city)
#    assign(paste("uerate_",sbcities_edd_out[i],sep=""),uerate_city_x12@d11)
#}
#data <- merge(as.xts(uerate_Buellton),
#              as.xts(uerate_Carpinteria),
#              as.xts(uerate_Goleta),
#              as.xts(uerate_Guadalupe),
#              as.xts(uerate_Lompoc),
#              as.xts(uerate_SantaBarbara),
#              as.xts(uerate_SantaMaria),
#              as.xts(uerate_Solvang))
#
#data_temp_1        <- matrix(data,ncol=dim(data)[2])
#data_temp_2        <- data.frame(data_temp_1,as.Date(time(data)))
#names(data_temp_2) <- c("uerate_Buellton","uerate_Carpinteria","uerate_Goleta","uerate_Guadalupe","uerate_Lompoc","uerate_SantaBarbara","uerate_SantaMaria","uerate_Solvang","date")
#write.csv(data_temp_2,file=paste(outloc_amcharts,"uerate_cities_amchart.csv",sep=""),row.names=FALSE)
#
## --------------------------- #
## ----- Diffusion Index ----- #
## --------------------------- #
#
#data               <- merge(as.xts(sbc_industry_diffusion_6mo), as.xts(sbc_industry_diffusion_12mo))
#data_temp_1        <- matrix(data["1990-12-15/"],ncol=dim(data)[2])
#data_temp_2        <- data.frame(data_temp_1,as.Date(time(data["1990-12-15/"])))
#data_temp_2$line   <- .5
#names(data_temp_2) <- c("6 month","12 month","date","line")
#write.csv(data_temp_2,file=paste(outloc_amcharts,"diffindex_6mo_12mo.csv",sep=""),row.names=FALSE)
#
#
## ---------------------------------- #
## ----- Carp Temporary Figures ----- #
## ---------------------------------- #
#
#empl_city     <- ts(data_city_all[which(data_city_all$Area == "Carpinteria city"),7],start = 2010,deltat = 1/12)
#empl_city_x12 <- x12(empl_city)
#emples        <- merge(as.xts(empl_city_x12@a1),as.xts(empl_city_x12@d11))
#names(emples) <- c("Original Series","Seasonally Adjusted")
#chart.TimeSeries(emples/1000,
#        period.areas=cycles.dates,
#        period.color="lightsteelblue1",
#        lwd=c(2,3),
#        col=c("deepskyblue4","brown3","cornflowerblue"),
#        main="Total Employment, All Industries, Carpinteria City",
#        ylab="Number Employed (Thousands)",
#        xlab="",
#        minor.ticks=FALSE,
#        major.ticks="year",
#        date.format="%b %Y",
#        grid.color = "grey26",
#        grid.lty = "dotted",
#        legend.loc="topleft",
#        pch=NULL,
#)
#emples<- as.xts(diff(empl_city_x12@a1))
#chart.TimeSeries(emples,
#        period.areas=cycles.dates,
#        period.color= "lightsteelblue1",
#        lwd=c( 2, 3),
#        col=c( "deepskyblue4","brown3" ,"cornflowerblue" ),
#        main= "Monthly Employment Change, Original Series, Carpinteria City",
#        ylab= "Number Employed",
#        xlab= "",
#        minor.ticks= FALSE,
#        major.ticks= "year",
#        date.format= "%b %Y",
#        grid.color = "grey26",
#        grid.lty = "dotted",
#        #legend.loc="topleft",
#        pch= NULL,
#)
#box(col="white", lwd=3)
#mtext("UCSB Economic Forecast Project: www.efp.ucsb.edu",
#        side = 4,
#        line= 0,
#        cex = .8,
#        adj = 0)
#mtext("Source: California Employment Development Department (EDD)",
#        side = 4,
#        line= 1,
#        cex = .8,
#        adj = 0)
#mtext(paste("Most Recent (Unadjusted) =",format(empl_city[length(empl_city)],big.mark=",",scientific=F)),
#        side = 1,
#        line= 2.4,
#        cex = .8,
#        adj = 0)
#mtext( paste("Most Recent (Adjusted) =",format(round(empl_city_x12@d11[length(empl_city_x12@d11)]),big.mark=",",scientific=F)),
#        side = 1,
#        line= 3.2,
#        cex = .8,
#        adj = 0)
#mtext(paste("Percent Change (Month) =",round(tail(Delt(empl_city_x12@d11),n=1)*100,digits=2),
#        "%  and  Percent Change (Year) =",round(tail(Delt(empl_city_x12@d11,k=12),n=1)*100,digits=2),"%"),
#        side = 1,
#        line= 4,
#        cex = .8,
#        adj = 0)
#dev.copy2pdf(file=paste(outloc_figs,"carp_empl_diff.pdf",sep=""), pointsize=12, width=8, height=6)
## }}}
